% -*- root: Dissertation.tex -*-
\documentclass[Dissertation.tex]{subfiles} 
\begin{document}


\chapter{Program Descriptions}
\label{chp:Programs}

\lettrine{\textcolor{startcolor}{D}}{oing} this work required writing multiple
codes, and I have made my codes available on GitHub at 
\url{https://github.com/DentonW/Ps-H-Scattering} \cite{GitHub}. Much of the
codes are what is described in \cref{chp:Computation}. A flowchart of the
steps required to calculate phase shifts and any additional quantities, such
as cross sections, is given by \cref{fig:ProgramFlowchart}.

\begin{figure}
	\centering
	\includegraphics[width=4.5in]{ProgramFlowchart}
	\caption{Flowchart for programs and scripts}
	\label{fig:ProgramFlowchart}
\end{figure}

The short-range program typically only needs to be run once for a partial wave,
and those short-range matrix elements are used for all $\kappa$ runs. For
$\ell \geq 2$, we have a low and high $\kappa$ set of nonlinear parameters, so
there are two runs of the short-range program that have to be done. The
long-range program is run for every $\kappa$ value for each partial wave, and
if needed, we restrict the short-range terms using Todd's method from
\cref{sec:ToddBound}. Then the phase shift program uses these inputs to run
many Kohn-type variational methods and generate phase shifts. These phase shifts
can then be further analyzed with several scripts.

As the codes are freely available on GitHub, it is worthwhile to show the
directory structure when this package is downloaded with git or as a zip.
\Cref{fig:dirtree} shows this directory tree. The S-wave, P-wave, and D-wave
codes only work for their respective partial wave, and the code in ``General 
Code'' works for arbitrary $\ell$, as described in \cref{chp:WaveKohn,chp:General}.

\begin{figure}[H]
\label{fig:directory}       
\dirtree{%
.1 /.
%.2 S-Wave\DTcomment{test}.
.2 S-Wave.
.3 Long.
.3 Short.
.2 P-Wave.
.3 Long.
.3 Short.
.2 D-Wave.
.3 Long.
.3 Short.
.2 General Code.
.3 Long-Range.
.3 Phase Shift.
.3 Python Scripts.
.3 Short-Range.
.3 Text to Binary.
.2 Derivations and Tests.
}
\caption{Directory tree of code on GitHub \cite{GitHub}}
\label{fig:dirtree}
\end{figure}





\todoi{Should mention the Mathematica notebooks to generate Fortran lists for short-range matrix elements and possibly other programs}





%\begin{lstlisting}[label=some-code,caption=Some Code]
{
\singlespacing

\lstset{captionpos=b,frame=lines,numbers=left,basicstyle=\tiny,numberstyle=\tiny,numbersep=5pt,breaklines=true,showstringspaces=false,basicstyle=\footnotesize,emph={label}}
\begin{lstlisting}[caption=Set of integration points in m07n7.txt]
Number of quadrature points for the various matrix elements

Long-long: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, r13 Leg, phi23
75 40 40 40 40 25 25 25
Long-long 2/r23 term: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, phi12, r13 Leg, r23 Leg
75 40 40 40 40 25 25 25

Short-long with qi = 0: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, r13 Leg
100 65 45 65 45 45 45 45
Short-long 2/r23 term with qi = 0: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, phi13, r23 Leg
115 65 45 65 60 45 45 45
Short-long full with qi > 0: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, r13 Leg, phi23
100 65 45 65 45 45 45 45

r2 and r3 integration cusp unimportant
100.0
100.0
Nonlinear parameter mu
0.7
Power of shielding function
7
Lambda
1.0 1.0 1.0
\end{lstlisting}

}



\section{XML, MySQL Database, and IPython}
\label{sec:XMLSQLIPy}

\todoi{Make sure to mention the form of the database described in the book I have been reading over MySQL and web programming}

Normal forms:
\cite{Phlonx} and \cite{Kent1983}


\url{http://plot.ly/~Denton}


%\section{}
%\label{sec:}

Hylleraas Three-Electron Integral Recursion Relations at \url{http://dx.doi.org/10.6084/m9.figshare.1419455}

\url{http://www.labarchives.com/}

\cite{GitHub}
\cite{Wiki}
\cite{figshare}



\section{Extrapolation Program}
I wrote a Python \cite{Python} program to extrapolate the phase shifts for a 
run for all Kohn method variants used, including the 35 values of $\tau$ used 
in each of the generalized Kohn, generalized $S$-matrix Kohn, and generalized
$T$-matrix Kohn. The extrapolation is performed with a least-squares fitting 
using the \texttt{polyfit} function of the SciPy package \cite{SciPy} to the 
form of \cref{eq:PhaseExtrap}. This program can do the extrapolation over any 
interval of $\omega$ values requested. The extrapolations from the 109 total 
Kohn variants are compared to see if there is any large discrepancy between 
them, indicating numerical instability. The phase shift can have a 
singularity in the generalized Kohn method as seen in \cref{fig:schwartz-singularity}, so 
care must be taken to ensure extrapolations are not taken around this interval.


\biblio
\end{document}
