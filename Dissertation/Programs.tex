% -*- root: Dissertation.tex -*-
\documentclass[Dissertation.tex]{subfiles} 
\begin{document}


\chapter{Program Descriptions}
\label{chp:Programs}

\iftoggle{UNT}{Doing}{\lettrine{\textcolor{startcolor}{D}}{oing}}
this work required writing multiple
codes, and I have made my codes available on GitHub at 
\url{https://github.com/DentonW/Ps-H-Scattering} \cite{GitHub}. Much of the
codes are what is described in \cref{chp:Computation}. A flowchart of the
steps required to calculate phase shifts and any additional quantities, such
as cross sections, is given by \cref{fig:ProgramFlowchart}.

\begin{figure}
	\centering
	\includegraphics[width=4.5in]{ProgramFlowchart}
	\caption{Flowchart for programs and scripts}
	\label{fig:ProgramFlowchart}
\end{figure}

The short-range program typically only needs to be run once for a partial wave,
and those short-range matrix elements are used for all $\kappa$ runs. For
$\ell \geq 2$, we have a low and high $\kappa$ set of nonlinear parameters, so
there are two runs of the short-range program that have to be done. The
long-range program is run for every $\kappa$ value for each partial wave, and
if needed, we restrict the short-range terms using Todd's method from
\cref{sec:ToddBound}. Then the phase shift program uses these inputs to run
many Kohn-type variational methods and generate phase shifts. These phase shifts
can then be further analyzed with several scripts.

%\section{GitHub Codes}
%\label{sec:GitHub}

As the codes are freely available on GitHub, it is worthwhile to show the
directory structure when this package is downloaded with git or as a zip.
\Cref{fig:dirtree} shows this directory tree. The S-wave, P-wave, and D-wave
codes only work for their respective partial wave, and the code in ``General 
Code'' works for arbitrary $\ell$, as described in \cref{chp:WaveKohn,chp:General}.

\begin{figure}[H]
\label{fig:directory}       
\dirtree{%
.1 /.
%.2 S-Wave\DTcomment{test}.
.2 S-Wave.
.3 Long.
.3 Short.
.2 P-Wave.
.3 Long.
.3 Short.
.2 D-Wave.
.3 Long.
.3 Short.
.2 General Code.
.3 Comparison.
.3 Long-Range.
.3 Phase Shift.
.3 Python Scripts.
.3 Short-Range.
%.3 Text to Binary.
.3 Todd Method.
.2 Derivations and Tests.
}
\caption{Directory tree of code on GitHub \cite{GitHub}}
\label{fig:dirtree}
\end{figure}

\subsection*{S-, P-, and D-wave Codes}
The S-, P-, and D-wave folders each have a Short subfolder (short-short
code) and a Long subfolder (short-long and long-long code). As shown in
the flowchart in \cref{fig:ProgramFlowchart}, the Short code is run first,
and then Long code is run for all $\kappa$ values of interest. An example
input parameter file to the Long code is in \cref{lst:IntPts}. To obtain
phase shifts, use the "Phase Shift" code in the "General Code" folder.
Extrapolations, etc.\ are also in the "General Code" folder.

\subsection*{General Short and Long}
The general Short and Long codes act similarly to the S-, P-, and D-wave
codes but for arbitrary $\ell$. It should be noted that because these
codes are general, they are much slower than running the corresponding
code specific to a partial wave if $\ell \leq 2$.


%%\begin{lstlisting}[label=some-code,caption=Some Code]
%{
%\singlespacing
%
%\lstset{captionpos=b,frame=lines,numbers=left,basicstyle=\tiny,numberstyle=\tiny,numbersep=5pt,breaklines=true,showstringspaces=false,basicstyle=\footnotesize,emph={label},label=lst:IntPts}
%\begin{lstlisting}[caption=Set of integration points in m07n7.txt]
%Number of quadrature points for the various matrix elements
%
%Long-long: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, r13 Leg, phi23
%75 40 40 40 40 25 25 25
%Long-long 2/r23 term: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, phi12, r13 Leg, r23 Leg
%75 40 40 40 40 25 25 25
%
%Short-long with qi = 0: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, r13 Leg
%100 65 45 65 45 45 45 45
%Short-long 2/r23 term with qi = 0: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, phi13, r23 Leg
%115 65 45 65 60 45 45 45
%Short-long full with qi > 0: r1 Lag, r2 Leg, r2 Lag, r3 Leg, r3 Lag, r12 Leg, r13 Leg, phi23
%100 65 45 65 45 45 45 45
%
%r2 and r3 integration cusp unimportant
%100.0
%100.0
%Nonlinear parameter mu
%0.7
%Power of shielding function
%7
%Lambda
%1.0 1.0 1.0
%\end{lstlisting}
%
%}

\subsection*{Phase Shifts}
The phase shift code, located in ``General Code/Phase Shift'', uses the
outputs of the Short and Long codes from the S-Wave, P-Wave, D-wave or
``General Code'' folders to calculate the phase shifts. An optional file
describing which short-range terms to use (such as that generated by the
``Todd Code''), can also be used as an input. The output is an XML file
showing phase shifts calculated for every N value for each of the 109
total Kohn-type methods used.

\subsection*{Extrapolation Program}
I wrote a Python \cite{Python} script, located in ``General Code/Python Scripts'',
to extrapolate the phase shifts for a 
run for all Kohn-type methods used, including the 35 values of $\tau$ used 
in each of the generalized Kohn, generalized $S$-matrix Kohn, and generalized
$T$-matrix Kohn. The extrapolation is performed with a least-squares fitting 
using the \texttt{polyfit} function of the SciPy package \cite{SciPy} to the 
form of \cref{eq:PhaseExtrap}. This program can do the extrapolation over any 
interval of $\omega$ values requested. The extrapolations from the 109 total 
Kohn-type methods are compared to see if there is any large discrepancy between 
them, indicating numerical instability. The phase shifts can have a 
singularity in the real-valued Kohn-type variational methods
as seen in \cref{fig:schwartz-singularity}, so 
care must be taken to ensure extrapolations are not taken around this interval.

%\subsection*{Text to Binary}
%Right now, the short-range code output is run through this program to generate
%a .psh file, which is a binary format instead of the text-based format that the
%short-short code outputs. The .psh file is what is actually used in the various
%programs that use the short-short files as input. This exists mainly due to 
%legacy reasons of having restricted storage on the older Talon 1 computing 
%cluster, and this intermediate step will be removed in future versions.

\subsection*{Derivations and Tests}
The ``General Code/Derivations and Tests'' folder has files referenced
throughout this document that are usually \emph{Mathematica} notebooks.
Examples are the ``Shielding Factor.nb'' notebook that is referenced in
\cref{sec:ShieldingFunc} and notebooks to generate the powers and coefficients
needed for the short-short integrations for each partial wave.


%\section{XML, MySQL Database, and IPython}
%\label{sec:XMLSQLIPy}
%
%\todoi{Make sure to mention the form of the database described in the book I have been reading over MySQL and web programming}
%
%Normal forms:
%\cite{Phlonx} and \cite{Kent1983}
%
%
%\url{http://plot.ly/~Denton}
%
%
%%\section{}
%%\label{sec:}
%
%Hylleraas Three-Electron Integral Recursion Relations at \url{http://dx.doi.org/10.6084/m9.figshare.1419455}
%
%\url{http://www.labarchives.com/}
%
%\cite{GitHub}
%\cite{Wiki}
%\cite{figshare}




\biblio
\end{document}
